StringArtGenerator.prototype.InitCanvas=function(t){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.dpr=window.devicePixelRatio||1,this.canvas.width=this.width*this.dpr,this.canvas.height=this.height*this.dpr,this.ctx.scale(this.dpr,this.dpr),this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.fakeCanvas=document.createElement("canvas"),this.fakeCanvas.width=this.width*this.dpr,this.fakeCanvas.height=this.height*this.dpr,this.fakeCtx=this.fakeCanvas.getContext("2d"),this.fakeCtx.scale(this.dpr,this.dpr),this.pixelCanvas=document.createElement("canvas"),this.pixelCanvas.width=this.width,this.pixelCanvas.height=this.height,this.pixelCtx=this.pixelCanvas.getContext("2d"),this.x0=this.width/2,this.y0=this.height/2,this.radius=Math.min(this.width,this.height)/2-PADDING},StringArtGenerator.prototype.InitSelectButton=function(){this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.accept="image/*",this.fileInput.addEventListener("change",(t=>this.SelectImage(t))),this.selectBtn=document.getElementById("select-btn"),this.selectBtn.addEventListener("click",(()=>this.fileInput.click()))},StringArtGenerator.prototype.InitControls=function(){this.dragDropBox=document.getElementById("drag-drop-box"),this.controlsBox=document.getElementById("controls-box"),this.formTypeBox=document.getElementById("form-type-box"),this.formTypeBox.addEventListener("change",(()=>this.UpdateForm())),this.invertBox=document.getElementById("invert-box"),this.invertBox.addEventListener("change",(()=>this.DrawLoadedImage())),this.drawBox=document.getElementById("draw-box"),this.drawBox.addEventListener("change",(()=>this.changeDrawble())),this.contrastBox=document.getElementById("contrast-box"),this.contrastValue=document.getElementById("contrast-value"),this.contrastBox.addEventListener("input",(()=>this.UpdateContrast())),this.contrastBox.addEventListener("change",(()=>{this.UpdateContrast(),this.DrawLoadedImage()})),this.brightnessBox=document.getElementById("brightness-box"),this.brightnessValue=document.getElementById("brightness-value"),this.brightnessBox.addEventListener("input",(()=>this.UpdateBrightness())),this.brightnessBox.addEventListener("change",(()=>{this.UpdateBrightness(),this.DrawLoadedImage()})),this.nailsModeBox=document.getElementById("nails-mode-box"),this.nailsModeBox.addEventListener("change",(()=>this.InitNails())),this.nailsCountBox=document.getElementById("nails-count-box"),this.nailsCountBox.addEventListener("change",(()=>this.InitNails())),this.linesCountBox=document.getElementById("lines-count-box"),this.linesWeightBox=document.getElementById("lines-weight-box"),this.linesWeightBox.addEventListener("input",(()=>this.UpdateWeight())),this.linesWeightBox.addEventListener("change",(()=>this.UpdateWeight())),this.linesWeightValue=document.getElementById("lines-weight-value"),this.linesColorBox=document.getElementById("lines-color-box"),this.backgroundColorBox=document.getElementById("background-color-box"),this.backgroundColorBox.addEventListener("change",(()=>this.DrawLoadedImage())),this.backgroundColorBox.addEventListener("input",(()=>this.DrawLoadedImage())),this.infoBox=document.getElementById("info-box"),this.generateBtn=document.getElementById("generate-btn"),this.generateBtn.addEventListener("click",(()=>this.Generate())),this.resetBtn=document.getElementById("reset-btn"),this.resetBtn.addEventListener("click",(()=>this.Reset(!this.isLineDrawing))),this.statusBox=document.getElementById("status-box"),this.controls=[this.selectBtn,this.invertBox,this.contrastBox,this.drawBox,this.brightnessBox,this.formTypeBox,this.nailsModeBox,this.nailsCountBox,this.linesCountBox,this.linesWeightBox,this.linesColorBox,this.backgroundColorBox,this.resetBtn],this.UpdateContrast(),this.UpdateBrightness()},StringArtGenerator.prototype.changeDrawble=function(){this.isDraw=this.drawBox.checked},StringArtGenerator.prototype.InitSave=function(){this.saveBox=document.getElementById("save-box"),this.saveTypeBox=document.getElementById("save-type-box"),this.saveBtn=document.getElementById("save-btn"),this.saveBtn.addEventListener("click",(()=>this.Save()))},StringArtGenerator.prototype.InitEvents=function(){this.canvas.addEventListener("mousedown",(t=>this.MouseDown(t))),this.canvas.addEventListener("mousemove",(t=>this.MouseMove(t))),this.canvas.addEventListener("mouseup",(t=>this.MouseUp(t))),this.canvas.addEventListener("mouseleave",(t=>this.MouseUp(t))),this.canvas.addEventListener("mousewheel",(t=>this.MouseWheel(t))),this.canvas.addEventListener("wheel",(t=>this.MouseWheel(t))),this.touches=[],this.canvas.addEventListener("touchstart",(t=>{this.TouchStart(t)})),this.canvas.addEventListener("touchmove",(t=>{this.TouchMove(t)})),this.canvas.addEventListener("touchend",(t=>{this.TouchEnd(t)}));let t=document.getElementById("generator-box");t.addEventListener("dragover",(t=>this.DragOver(t))),t.addEventListener("dragleave",(t=>this.DragLeave(t))),t.addEventListener("drop",(t=>this.Drop(t)))},StringArtGenerator.prototype.Interpolate=function(t,e,i){return t*i+e*(1-i)},StringArtGenerator.prototype.GetCircleNail=function(t){return{x:this.x0+this.radius*Math.cos(t),y:this.y0+this.radius*Math.sin(t)}},StringArtGenerator.prototype.GetRectNail=function(t,e,i,s,n){let h,o,a=t/(2*Math.PI),r=.5/(1+s/n),d=[0,r,.5,.5+r,1];return a<d[1]?(h=e+s/2,o=this.Interpolate(i-n/2,i+n/2,(a-d[0])/(d[1]-d[0]))):a<d[2]?(h=this.Interpolate(e-s/2,e+s/2,(a-d[1])/(d[2]-d[1])),o=i+n/2):a<d[3]?(h=e-s/2,o=this.Interpolate(i+n/2,i-n/2,(a-d[2])/(d[3]-d[2]))):(h=this.Interpolate(e+s/2,e-s/2,(a-d[3])/(d[4]-d[3])),o=i-n/2),{x:h,y:o}},StringArtGenerator.prototype.InitBorderNails=function(t){let e=2*Math.PI/t,i=[];for(let s=0;s<t;s++){let t={x:0,y:0},n=s*e;if(this.formType==CIRCLE_FORM)t=this.GetCircleNail(n);else if(this.formType==RECT_FORM)t=this.GetRectNail(n,this.x0,this.y0,this.width-2*PADDING,this.height-2*PADDING);else if(this.formType==ALBUM_FORM){let e=this.width-2*PADDING;t=this.GetRectNail(n,this.x0,this.y0,e,e/Math.sqrt(2))}else if(this.formType==PORTRAIT_FORM){let e=this.height-2*PADDING;t=this.GetRectNail(n,this.x0,this.y0,e/Math.sqrt(2),e)}else if(this.formType==IMAGE_FORM){let e=this.imgWidth-2*PADDING,i=this.imgHeight-2*PADDING;t=this.GetRectNail(n,this.imgWidth/2,this.imgHeight/2,e,i)}t.x=Math.round(t.x),t.y=Math.round(t.y),i.push(t)}return i},StringArtGenerator.prototype.InitGridNails=function(t){let e=[],i=(this.imgBbox.xmax-this.imgBbox.xmin)/(this.imgBbox.ymax-this.imgBbox.ymin),s=this.formType==CIRCLE_FORM?2/Math.sqrt(Math.PI):1,n=Math.round(Math.sqrt(t*i*s)),h=Math.round(Math.sqrt(t/i*s)*s),o=(this.imgBbox.xmin+this.imgBbox.xmax)/2,a=(this.imgBbox.ymin+this.imgBbox.ymax)/2;for(let t=0;t<h;t++)for(let i=0;i<n;i++){let s=this.Interpolate(this.imgBbox.xmin+PADDING,this.imgBbox.xmax-PADDING,i/(n-1)),r=this.Interpolate(this.imgBbox.ymin+PADDING,this.imgBbox.ymax-PADDING,t/(h-1));if(this.formType==CIRCLE_FORM){let t=s-o,e=r-a;if(t*t+e*e>this.radius*this.radius)continue}e.push({x:Math.round(s),y:Math.round(r)})}return e},StringArtGenerator.prototype.InitGridRandom=function(t){let e=[];for(let i=0;i<t;i++){let t,i;if(this.formType==CIRCLE_FORM){let e=2*Math.random()*Math.PI,s=this.radius*Math.sqrt(Math.random());t=(this.imgBbox.xmin+this.imgBbox.xmax)/2+s*Math.cos(e),i=(this.imgBbox.ymin+this.imgBbox.ymax)/2+s*Math.sin(e)}else t=this.imgBbox.xmin+Math.random()*(this.imgBbox.xmax-this.imgBbox.xmin),i=this.imgBbox.ymin+Math.random()*(this.imgBbox.ymax-this.imgBbox.ymin);e.push({x:Math.round(t),y:Math.round(i)})}return e},StringArtGenerator.prototype.InitNails=function(){let t=this.nailsModeBox.value,e=+this.nailsCountBox.value;this.nails=[],t==BORDER_MODE?this.nails=this.InitBorderNails(e):t==GRID_MODE?this.nails=this.InitGridNails(e):t==RANDOM_MODE&&(this.nails=this.InitGridRandom(e))},StringArtGenerator.prototype.LineRasterization=function(t,e,i,s){let n=new Set,h=Math.abs(i-t),o=Math.abs(s-e),a=Math.sign(i-t),r=Math.sign(s-e),d=h-o;for(;t!=i||e!=s;)n.add(e*this.width+t),error2=2*d,error2>-o&&(d-=o,t+=a),error2<h&&(d+=h,e+=r);return n.add(s*this.width+i),n},StringArtGenerator.prototype.InitBbox=function(){if(this.imgBbox={xmin:0,ymin:0,xmax:this.width,ymax:this.height},this.formType==ALBUM_FORM){let t=Math.round(this.width/Math.sqrt(2));this.imgBbox.ymin=Math.round((this.height-t)/2),this.imgBbox.ymax=this.imgBbox.ymin+t}else if(this.formType==PORTRAIT_FORM){let t=Math.round(this.height/Math.sqrt(2));this.imgBbox.xmin=Math.round((this.width-t)/2),this.imgBbox.xmax=this.imgBbox.xmin+t}else this.formType==IMAGE_FORM&&(this.imgBbox.xmax=this.imgWidth,this.imgBbox.ymax=this.imgHeight);this.NormalizePoint()};
//# sourceMappingURL=StringArtGenerator.b5e2174e.js.map
