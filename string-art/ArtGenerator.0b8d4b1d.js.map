{"mappings":"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","sources":["src/string-art/js/events.js"],"sourcesContent":["StringArtGenerator.prototype.Clip = function (value, min, max) {\n  if (min > max) [min, max] = [max, min];\n\n  if (value > max) return max;\n\n  if (value < min) return min;\n\n  return value;\n};\n\nStringArtGenerator.prototype.NormalizePoint = function () {\n  this.imgX = this.Clip(\n    this.imgX,\n    this.imgBbox.xmin,\n    this.imgBbox.xmax - this.imgWidth * this.imgScale\n  );\n  this.imgY = this.Clip(\n    this.imgY,\n    this.imgBbox.ymin,\n    this.imgBbox.ymax - this.imgHeight * this.imgScale\n  );\n};\n\nStringArtGenerator.prototype.TouchToPoint = function (touch) {\n  return { x: Math.round(touch.clientX), y: Math.round(touch.clientY) };\n};\n\nStringArtGenerator.prototype.GetPointDistance = function (p1, p2) {\n  let dx = p2.x - p1.x;\n  let dy = p2.y - p1.y;\n\n  return Math.sqrt(dx * dx + dy * dy);\n};\n\nStringArtGenerator.prototype.MaxAbs = function (a, b) {\n  return Math.abs(a) > Math.abs(b) ? a : b;\n};\n\nStringArtGenerator.prototype.MouseDown = function (e) {\n  this.isPressed = true;\n  this.prevX = e.offsetX;\n  this.prevY = e.offsetY;\n  e.preventDefault();\n};\n\nStringArtGenerator.prototype.MouseMove = function (e) {\n  e.preventDefault();\n\n  if (!this.isPressed || this.isGenerating || this.isLineDrawing) return;\n\n  let dx = e.offsetX - this.prevX;\n  let dy = e.offsetY - this.prevY;\n\n  this.imgX += dx;\n  this.imgY += dy;\n\n  this.prevX = e.offsetX;\n  this.prevY = e.offsetY;\n\n  this.NormalizePoint();\n  this.DrawLoadedImage();\n};\n\nStringArtGenerator.prototype.MouseUp = function (e) {\n  e.preventDefault();\n  this.isPressed = false;\n};\n\nStringArtGenerator.prototype.ChangeSize = function (e) {\n  e.preventDefault();\n\n  if (this.isGenerating || this.isLineDrawing) return;\n\n  let scale = e.target.value * 1;\n  this.UpdateSizePhoto(scale);\n  this.SetScale(\n    scale,\n    this.canvas.scrollWidth / 2,\n    this.canvas.scrollHeight / 2\n  );\n  this.NormalizePoint();\n  this.DrawLoadedImage();\n};\n\nStringArtGenerator.prototype.MouseWheel = function (e) {\n  e.preventDefault();\n\n  if (this.isGenerating || this.isLineDrawing) return;\n\n  let scaleIndex = SCALES.indexOf(this.imgScale) - Math.sign(e.deltaY);\n  let scale = SCALES[Math.max(0, Math.min(SCALES.length - 1, scaleIndex))];\n\n  // console.log(this.canvas.scrollWidth / 2, this.canvas.scrollWidth / 2);\n  this.UpdateSizePhoto(scale);\n  this.SetScale(scale, e.offsetX, e.offsetY);\n  this.NormalizePoint();\n  this.DrawLoadedImage();\n};\n\nStringArtGenerator.prototype.DragOver = function (e) {\n  this.dragDropBox.style.display = \"\";\n  e.preventDefault();\n};\n\nStringArtGenerator.prototype.DragLeave = function (e) {\n  this.dragDropBox.style.display = \"none\";\n  e.preventDefault();\n};\n\nStringArtGenerator.prototype.Drop = function (e) {\n  e.preventDefault();\n  this.dragDropBox.style.display = \"none\";\n\n  if (e.dataTransfer.files.length != 1) {\n    alert(\"Можно перетащить не более одного файла\");\n    return;\n  }\n\n  let image = new Image();\n  image.onload = () => this.LoadImage(image);\n  image.src = URL.createObjectURL(e.dataTransfer.files[0]);\n};\n\nStringArtGenerator.prototype.TouchStart = function (e) {\n  e.preventDefault();\n  this.touches = [];\n\n  if (e.targetTouches.length == 1) {\n    let point = this.TouchToPoint(e.targetTouches[0]);\n    e.offsetX = point.x;\n    e.offsetY = point.y;\n    this.MouseDown(e);\n  } else if (e.targetTouches.length == 2) {\n    this.touches.push(this.TouchToPoint(e.targetTouches[0]));\n    this.touches.push(this.TouchToPoint(e.targetTouches[1]));\n  }\n};\n\nStringArtGenerator.prototype.TouchMove = function (e) {\n  if (!this.isPressed || this.isGenerating || this.isLineDrawing) return;\n\n  e.preventDefault();\n\n  if (e.targetTouches.length == 1) {\n    let point = this.TouchToPoint(e.targetTouches[0]);\n    e.offsetX = point.x;\n    e.offsetY = point.y;\n    this.MouseMove(e);\n    return;\n  }\n\n  if (e.targetTouches.length != 2) return;\n\n  let p1 = this.TouchToPoint(e.targetTouches[0]);\n  let p2 = this.TouchToPoint(e.targetTouches[1]);\n\n  let dst1 = this.GetPointDistance(this.touches[0], this.touches[1]);\n  let dst2 = this.GetPointDistance(p1, p2);\n\n  if (Math.abs(dst2 - dst1) > TOUCH_DELTA)\n    this.SetScale(\n      (this.imgScale * dst2) / dst1,\n      (p1.x + p2.x) / 2,\n      (p1.y + p2.y) / 2\n    );\n\n  let dx1 = p1.x - this.touches[0].x;\n  let dx2 = p2.x - this.touches[1].x;\n\n  if (Math.sign(dx1) == Math.sign(dx2)) this.imgX += this.MaxAbs(dx1, dx2);\n\n  let dy1 = p1.y - this.touches[0].y;\n  let dy2 = p2.y - this.touches[1].y;\n\n  if (Math.sign(dy1) == Math.sign(dy2)) this.imgY += this.MaxAbs(dy1, dy2);\n\n  this.touches = [p1, p2];\n\n  this.NormalizePoint();\n  this.DrawLoadedImage();\n};\n\nStringArtGenerator.prototype.TouchEnd = function (e) {\n  e.preventDefault();\n  this.isPressed = false;\n};\n"],"names":["StringArtGenerator","prototype","Clip","value","min","max","NormalizePoint","this","imgX","imgBbox","xmin","xmax","imgWidth","imgScale","imgY","ymin","ymax","imgHeight","TouchToPoint","touch","x","Math","round","clientX","y","clientY","GetPointDistance","p1","p2","dx","dy","sqrt","MaxAbs","a","b","abs","MouseDown","e","isPressed","prevX","offsetX","prevY","offsetY","preventDefault","MouseMove","isGenerating","isLineDrawing","DrawLoadedImage","MouseUp","ChangeSize","scale","target","UpdateSizePhoto","SetScale","canvas","scrollWidth","scrollHeight","MouseWheel","scaleIndex","SCALES","indexOf","sign","deltaY","length","DragOver","dragDropBox","style","display","DragLeave","Drop","dataTransfer","files","alert","image","Image","onload","LoadImage","src","URL","createObjectURL","TouchStart","touches","targetTouches","point","push","TouchMove","dst1","dst2","TOUCH_DELTA","dx1","dx2","dy1","dy2","TouchEnd"],"version":3,"file":"ArtGenerator.0b8d4b1d.js.map"}